[{"content":"üß† 02 - Migrating to a Dedicated Management VLAN (VLAN 99) This phase documents the migration of all core management infrastructure to an isolated VLAN (VLAN 99) for improved security, network segmentation, and long-term scalability. This included Proxmox GUI access, Omada Controller LXC, and strict firewall rules enforced via pfSense.\nüéØ Goals Remove critical services from default/native VLAN\nAssign a dedicated, isolated VLAN (VLAN 99) for:\n- Proxmox management GUI\n- Omada Controller (LXC)\nTrunk management VLAN through switch to Proxmox\nImplement firewall rules to allow remote admin access only\nPreserve service availability during transition\nüß± Pre-Migration Topology | Component | Network | VLAN | Interface | Description |\n|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;|\u0026mdash;\u0026mdash;\u0026mdash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;|\n| Proxmox Host | LAN | VLAN 1 | vmbr0 | Static IP via native VLAN |\n| Omada Controller | LAN | VLAN 1 | vmbr0 | LXC container, web GUI on port 8043 |\n| Pi-hole | LAN | VLAN 1 | vmbr0 | DNS LXC |\n| VPN Tunnel | LAN | VLAN 1 | pfSense | Remote client-to-site access |\nüß† Post-Migration Topology | Component | Network | VLAN | Interface | Description |\n|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-|\u0026mdash;\u0026mdash;\u0026ndash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;|\n| Proxmox Host | Management | VLAN 99| vmbr1.99 | Tagged IP for GUI access via vmbr1 |\n| Omada Controller | Management | VLAN 99| vmbr1 (tagged)| LXC container with VLAN tag 99 |\n| Pi-hole | Lan | VLAN 1| vmbr0 | LXC container |\n| Trunk Port (Switch) | Trunked Port | 1,99,14| enp1s0 | Connected to VLAN-aware bridge vmbr1 |\n| VPN Tunnel | Routed to MGMT | VLAN 99| pfSense | Allows external admin access to VLAN 99 |\nüõ†Ô∏è Migration Steps 1. Created VLAN 99 in pfSense Interfaces \u0026gt; Assignments \u0026gt; VLANs\nCreated VLAN 99 on the LAN parent interface\nAssigned it as a new interface and renamed it to MGMT\nEnabled interface and gave it a static IP (management subnet)\n2. Configured Proxmox Bridge for VLAN Tagging Created a new VLAN-aware bridge and subinterface in /etc/network/interfaces:\nauto vmbr1 iface vmbr1 inet manual bridge-ports enp1s0 bridge-stp off bridge-fd 0 bridge-vlan-aware yes bridge-vids 2-4094 auto vmbr1.99 iface vmbr1.99 inet static address \u0026lt;management_ip\u0026gt;/24 gateway \u0026lt;management_gateway\u0026gt; ","permalink":"https://blog.tillynet.com/my-home-lab-journey/creating-network-management-isolation/","summary":"\u003ch1 id=\"-02---migrating-to-a-dedicated-management-vlan-vlan-99\"\u003eüß† 02 - Migrating to a Dedicated Management VLAN (VLAN 99)\u003c/h1\u003e\n\u003cp\u003eThis phase documents the migration of all core management infrastructure to an isolated VLAN (VLAN 99) for improved security, network segmentation, and long-term scalability. This included Proxmox GUI access, Omada Controller LXC, and strict firewall rules enforced via pfSense.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"-goals\"\u003eüéØ Goals\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRemove critical services from default/native VLAN\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAssign a dedicated, isolated VLAN (VLAN 99) for:\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e¬† - Proxmox management GUI\u003c/p\u003e","title":"Creating Network Management Isolation"},{"content":"üè° HomeLab: Initial Network Setup This project documents the first working phase of my home network infrastructure built on top of Proxmox, using pfSense as a virtual firewall/router and LXC containers to host internal services. The design lays the foundation for a scalable, secure, and isolated home lab environment.\nüåê Overview Hypervisor: Proxmox VE running on Protectli Vault (Intel J6412, 4 NICs)\nRouter/Firewall: pfSense VM\nInternal Services: - Pi-hole (LXC) ‚Äì local DNS + ad-blocking - Omada Controller (LXC) ‚Äì TP-Link AP management\nLAN Devices: Proxmox host, personal workstation, AP, switch\nGuest Devices: IoT \u0026amp; roommate devices on isolated VLAN 14\nüèóÔ∏è Infrastructure at a Glance | Component | Description |\n|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-|\n| pfSense | VM with two PCI-passthrough NICs (WAN + LAN) |\n| vmbr0 | Bridge for LAN (Proxmox + LXCs) |\n| vmbr1 | Reserved for future VLAN tagging (e.g., mgmt) |\n| Pi-hole | LXC container for DNS (on LAN) |\n| Omada Ctrl | LXC container managing TP-Link EAP670 AP |\n| Cisco Switch | Access switch trunking VLANs to Proxmox/AP |\n| Guest VLAN 14| WiFi-only VLAN for roommate \u0026amp; IoT devices |\nüöÄ Setup Timeline ‚úÖ Phase 1 ‚Äì Core Infrastructure Flashed Proxmox onto Protectli Vault\nCreated pfSense VM with 2 passthrough NICs:\n- WAN: connected to ISP modem\n- LAN: connected to Cisco switch (trunk-ready)\nConfigured vmbr0 as LAN bridge in Proxmox\nGave Proxmox host static IP on the LAN network\n‚úÖ Phase 2 ‚Äì Internal Services Provisioned LXC container for Pi-hole - Static IP assigned\n- Configured upstream DNS servers (e.g., Cloudflare)\nProvisioned LXC container for Omada Controller - Used to manage TP-Link EAP670 AP\n- Served on LAN via Omada web GUI (port 8043)\n‚úÖ Phase 3 ‚Äì Wireless \u0026amp; Guest VLAN Set up VLAN 14 in pfSense (Guest Network)\nTrunked VLANs through switch port to Omada AP\nCreated isolated wireless SSID mapped to VLAN 14\nConfigured firewall rules in pfSense:\n- Guests can access WAN only\n- Blocked access to LAN and Pi-hole\nVerified DHCP lease and internet access for guests\nObserved isolated traffic from personal network\nüîê Security Practices Created distinct VLANs for guest vs personal network\nIsolated Pi-hole to LAN access only\nDisabled inter-VLAN routing from Guest ‚Üí LAN\nAssigned firewall rules by interface in pfSense\nReserved management services for trusted VLAN only\nüîç To-Do / Next Steps Create VLAN 99 for network management\nMove Proxmox GUI and Omada Controller to VLAN 99\nAdd remote access via OpenVPN (completed later)\nDiagram full topology and backup strategy\nüì∏ Network Diagram (Coming Soon) !\nWill include: Proxmox bridges ‚Üí pfSense VM ‚Üí Switch trunk ‚Üí AP ‚Üí VLAN segmentation\nüß† Lessons Learned Always reserve a static fallback IP for management\npfSense is extremely powerful when paired with LXC containers\nVLANs and firewall rules are critical to proper isolation\nOmada Controller offers enterprise-like wireless management\nüìå Repo Series 01_initial-setup.md ‚Üí This doc\n02_management-vlan.md ‚Üí VLAN 99 migration\n03_remote-recovery.md ‚Üí Recovery via OpenVPN (see separate log)\n04_automation.md ‚Üí Cron/Ansible update automation\n05_certificates.md ‚Üí Internal SSL management (Pi-hole, Omada, pfSense)\nüßæ Resume Bullet (from this phase) Deployed full virtual home network lab with pfSense firewall, VLAN isolation, and internal services (DNS, WiFi controller) using Proxmox and LXC containers; implemented guest network segregation and trunked VLANs across Cisco infrastructure. ","permalink":"https://blog.tillynet.com/my-home-lab-journey/the-big-bang-how-it-all-began/","summary":"\u003ch1 id=\"-homelab-initial-network-setup\"\u003eüè° HomeLab: Initial Network Setup\u003c/h1\u003e\n\u003cp\u003eThis project documents the first working phase of my home network infrastructure built on top of Proxmox, using pfSense as a virtual firewall/router and LXC containers to host internal services. The design lays the foundation for a scalable, secure, and isolated home lab environment.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"-overview\"\u003eüåê Overview\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eHypervisor:\u003c/strong\u003e Proxmox VE running on Protectli Vault (Intel J6412, 4 NICs)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRouter/Firewall:\u003c/strong\u003e pfSense VM\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eInternal Services:\u003c/strong\u003e ¬†\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e¬† - Pi-hole (LXC) ‚Äì local DNS + ad-blocking ¬†\u003c/p\u003e","title":"The Big Bang (How it All Began)"}]